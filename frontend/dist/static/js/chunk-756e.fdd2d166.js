(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-756e"],{"+DNT":function(t,e,i){"use strict";i.r(e);var n=i("t3Un");var a=i("6NYe"),l=(i("p46w"),{name:"index",data:function(){return{userList:[],checkAll:!1,isIndeterminate:!0,menuList:[],tableLoading:!1,page:1,pagesize:30,total:0,editDialog:!1,editForm:{id:[],menu:[],type:0},multipleSelection:[]}},created:function(){this.getMenuList()},methods:{editAll:function(){this.editDialog=!0,this.editForm.type=1},handleCurrentChange:function(t){this.page=t,this.getUserList()},doEditMenu:function(){var t=this;(function(t){return Object(n.a)({url:"/editMenu",method:"post",data:t})})(this.editForm).then(function(e){"0000"==e.data.code?(t.$message.success("更新成功！"),t.editDialog=!1,t.editForm={id:[],menu:[],type:0},t.checkAll=!1,t.isIndeterminate=!0,t.getUserList()):t.$message.error("更新菜单失败！")}).catch(function(e){console.log(e),t.$message.error("网络错误，请重试！")})},getUserList:function(){var t=this,e={page:this.page,pagesize:this.pagesize};this.tableLoading=!0,function(t){return Object(n.a)({url:"/getMenuer",method:"post",data:t})}(e).then(function(e){var i=e.data;"0000"==i.code?(i.data.list.length>0&&(t.userList=[],t.userList=i.data.list.map(function(e){return e.menu=t.formatMenu(e.menus),e})),t.page=i.data.page,t.total=i.data.total,t.tableLoading=!1):t.$message.error("获取用户列表失败！")})},getMenuList:function(){var t=this;Object(n.a)({url:"/getMenus",method:"post"}).then(function(e){var i=e.data;"0000"==i.code?(i.data.length>0&&(t.menuList=i.data),t.getUserList()):t.$message.error("获取菜单列表失败！")}).catch(function(e){console.log(e),t.$message.error("网络错误，请重试！")})},checkAllMenu:function(t){var e=[];this.menuList.map(function(t){e.push(t.id)}),this.editForm.menu=t?e:[],this.isIndeterminate=!1},checkMenuChange:function(t){var e=t.length;this.checkAll=e===this.menuList.length,this.isIndeterminate=e>0&&e<this.menuList.length},formatMenu:function(t){if(t){if(t.length>0){t=t.split(",");var e="   ";return this.menuList.forEach(function(i){Object(a.a)(i.id,t)&&(e+=i.name+"   ")}),e}return""}return""},editBatch:function(){if(this.multipleSelection.length>0){var t=this.multipleSelection.map(function(t){return t.id});this.editForm.id=t,this.editDialog=!0}else this.$message({message:"请先选择用户",type:"warning"})},handleSelectionChange:function(t){this.multipleSelection=t},beforeDialogClose:function(){this.editDialog=!1,this.editForm={id:[],menu:[],type:0},this.checkAll=!1,this.isIndeterminate=!0},editUserMenu:function(t,e){var i=e.menus.split(",");i=i.map(function(t){return parseInt(t)}),this.checkAll=i.length===this.menuList.length,this.isIndeterminate=i.length>0&&i.length<this.menuList.length,this.editForm.menu=i,this.editForm.id=[e.id],this.editDialog=!0}}}),s=(i("qZbi"),i("KHd+")),r=Object(s.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("span",[t._v("快捷操作：")]),t._v(" "),i("el-button",{attrs:{type:"success",icon:"el-icon-upload2"},on:{click:t.editAll}},[t._v("一键设置")])],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"tableListView",staticStyle:{width:"100%","min-width":"600px"},attrs:{data:t.userList,border:""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55",align:"center",label:"全选"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"id","min-width":"50",label:"ID"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"username","min-width":"100",label:"用户名"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"role","min-width":"100",label:"角色"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"menu","min-width":"200",label:"菜单"}}),t._v(" "),i("el-table-column",{attrs:{align:"center","min-width":"150",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(i){t.editUserMenu(e.$index,e.row)}}},[t._v("编辑菜单\n                ")])]}}])})],1),t._v(" "),i("el-col",{staticClass:"toolbar",staticStyle:{"margin-top":"20px"},attrs:{span:24}},[i("el-button",{attrs:{type:"primary"},on:{click:t.editBatch}},[t._v("批量管理")])],1),t._v(" "),i("el-col",{staticClass:"toolbar",staticStyle:{"margin-top":"10px"},attrs:{span:24}},[i("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":t.pagesize,total:t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{title:"编辑菜单",visible:t.editDialog,width:"480px","before-close":t.beforeDialogClose},on:{"update:visible":function(e){t.editDialog=e}}},[i("el-form",{ref:"editForm",attrs:{model:t.editForm,size:"small"}},[i("el-form-item",{attrs:{prop:"menu"}},[i("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.checkAllMenu},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选\n                ")]),t._v(" "),i("div",{staticStyle:{margin:"15px 0"}}),t._v(" "),i("el-checkbox-group",{staticClass:"menuList",on:{change:t.checkMenuChange},model:{value:t.editForm.menu,callback:function(e){t.$set(t.editForm,"menu",e)},expression:"editForm.menu"}},t._l(t.menuList,function(e){return i("el-checkbox",{key:e.id,staticClass:"menuItem",attrs:{label:e.id}},[t._v(t._s(e.name)+"\n                    ")])}))],1),t._v(" "),i("div",{staticStyle:{"margin-top":"15px",display:"flex","justify-content":"flex-end"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.doEditMenu}},[t._v("更新")])],1)],1)],1)],1)},[],!1,null,"99cd2e3c",null);r.options.__file="index.vue";e.default=r.exports},"6NYe":function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i("FyfS"),a=i.n(n);function l(t,e){if(e.length>0){var i=!0,n=!1,l=void 0;try{for(var s,r=a()(e);!(i=(s=r.next()).done);i=!0){if(t==s.value)return!0}}catch(t){n=!0,l=t}finally{try{!i&&r.return&&r.return()}finally{if(n)throw l}}}return!1}},E3Sq:function(t,e,i){},qZbi:function(t,e,i){"use strict";var n=i("E3Sq");i.n(n).a}}]);